I"À<h1 id="steps-to-create-products_final">Steps to Create Products_Final</h1>

<h3 id="step-1-identify-issues-with-product_category">Step 1: Identify Issues with <code class="language-plaintext highlighter-rouge">product_category</code></h3>

<p>Realizing the numerous issues with category naming conventions in the <code class="language-plaintext highlighter-rouge">Products</code> table, I wrote a SQL query to extract all distinct <code class="language-plaintext highlighter-rouge">product_category</code> names for review:</p>

<details>
<summary>ðŸ“‚<b><i>Query to Select all Distinct Product Category Names</i></b></summary>

```sql
SELECT DISTINCT
  product_category
FROM
  iconic-fountain-435918-q3.Target_Ecommerce_Sales_2016_2018.Products
ORDER BY
  product_category
```  

- This gave me 74 different `product_category` names.

</details>

<h3 id="step-2-generate-and-review-cleaned-names">Step 2: Generate and Review Cleaned Names</h3>

<ul>
  <li>I imported the extracted list into Excel and used ChatGPT to generate an initial list of cleaned category names based on the original values.</li>
  <li>The cleaned names were reviewed and adjusted manually to ensure accuracy and relevance to the dataset.
    <ul>
      <li><strong>Example Adjustments</strong>:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">"CITTE AND UPHACK FURNITURE"</code> â†’ <code class="language-plaintext highlighter-rouge">"Miscellaneous Furniture"</code></li>
          <li><code class="language-plaintext highlighter-rouge">"Electrices 2"</code> â†’  <code class="language-plaintext highlighter-rouge">"Electrical Products"</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>The finalized list of original and standardized names were saved as a <code class="language-plaintext highlighter-rouge">.csv</code> file and uploaded to Google BigQuery as <code class="language-plaintext highlighter-rouge">Product_Category_Mappings</code>. The <code class="language-plaintext highlighter-rouge">.csv</code> file can be <a href="https://github.com/user-attachments/files/17782746/Product_Category_mappings.csv">downloaded here</a></li>
</ul>

<h3 id="step-3-create-products_final">Step 3: Create <code class="language-plaintext highlighter-rouge">Products_Final</code></h3>

<p>With the <code class="language-plaintext highlighter-rouge">Product_Category_Mappings</code> table in place, I created the <code class="language-plaintext highlighter-rouge">Products_Final</code> table by joining <code class="language-plaintext highlighter-rouge">Products</code> with <code class="language-plaintext highlighter-rouge">Product_Category_Mappings</code> using a <code class="language-plaintext highlighter-rouge">LEFT JOIN</code> and handling any missing product_category values with <code class="language-plaintext highlighter-rouge">COALESCE</code>.</p>

<details>
<summary>ðŸ“‚<b><i>Query to Create Products_Final</i></b></summary>

```sql
/* This query was to clean the Products table. The category names had numerous issues such as 
    inconsistent case, translation inconsistency, as well as confusing category naming. I did the following steps
        1. I created a .csv file with standardized category names. NOTE: In the case of "Miscellaneous Furniture"
        and "Electrical Products" the original names were unusual and are corrected as best guesses. Their original names were "Citte and Uphack Furniture"
        and "Electrices 2" respectively. 
        2. I uploaded the table to BigQuery and joined it with the Products table. The COALESCE function is there to handle any "null" values in product_category
        Where there are any nulls, they are referred to as "Uncategorizd".
*/
CREATE OR REPLACE TABLE `iconic-fountain-435918-q3.Target_Ecommerce_Sales_2016_2018.Products_Final` AS
SELECT 
    p.product_id,
    COALESCE(m.product_category_cleaned, 'Uncategorized') AS product_category,   
FROM 
    `iconic-fountain-435918-q3.Target_Ecommerce_Sales_2016_2018.Products` AS p
LEFT JOIN 
    `iconic-fountain-435918-q3.Target_Ecommerce_Sales_2016_2018.Product_Category_Mappings` AS m
ON 
    p.product_category = m.product_category
```  

#### Importance of `LEFT JOIN` and `COALESCE`
- **`LEFT JOIN`**:
  - Ensures that all `product_ids` from `Products` appear in `Products_Final`, even if no matching `product_category` exists in the mapping table.
  - This accounts for `product_ids` in the `Products` table with `NULL` values for `product_category`.
- **`COALESCE`**:
  - Replaces any `NULL` values in product_category with `"Uncategorized"`.
  - Ensures that every `product_id` in `Products_Final` has an associated `product_category`.

</details>

<h3 id="final-outcome">Final Outcome</h3>
<p>The resulting <code class="language-plaintext highlighter-rouge">Products_Final</code> table:</p>
<ul>
  <li>Standardizes all product_category names based on the <code class="language-plaintext highlighter-rouge">Product_Category_Mappings</code> table.</li>
  <li>Accounts for missing categories by assigning them the default value <code class="language-plaintext highlighter-rouge">"Uncategorized"</code>.</li>
  <li>Maintains all product_ids from the original <code class="language-plaintext highlighter-rouge">Products</code> table, ensuring data completeness.</li>
</ul>
:ET